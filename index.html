<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Humanity's Last Survival</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <main>
        <canvas id="gameCanvas"></canvas>
        <div id="event-notification-bar" class="hidden">
            <h3 id="event-title"></h3>
            <p id="event-description"></p>
            <div class="progress-bar-container">
                <div id="event-progress-bar"></div>
            </div>
        </div>
    </main>

    <div id="top-ui-container">
        <div id="resource-display">
            <p>Wood: <span id="wood-count">0</span></p>
            <p>Stone: <span id="stone-count">0</span></p>
            <p>Food: <span id="food-count">0</span></p>
            <p>Sand: <span id="sand-count">0</span></p>
            <p>Glass: <span id="glass-count">0</span></p>
            <p>Tools: <span id="tools-count">0</span></p>
            <p>Knowledge: <span id="knowledge-count">0</span></p>
            <p>Population: <span id="population-count">0</span>/<span id="population-cap">0</span></p>
            <p>Unemployed: <span id="unemployed-workers-count">0</span></p>
            <p>Happiness: <span id="happiness-count">100</span>%</p>
        </div>

        <div id="scenario-panel">
            <h2 id="scenario-title" role="button" tabindex="0">Getting Started <span id="scenario-toggle-icon">â–¼</span></h2>
            <ul id="objectives-list"></ul>
        </div>
    </div>

    <aside>
        <div class="tabs">
            <button class="tab-button active" onclick="openTab('build-menu')">Build</button>
            <button class="tab-button" onclick="openTab('research-panel')">Research</button>
            <button class="tab-button" onclick="openTab('settings-panel')">Settings</button>
        </div>

        <div id="build-menu" class="tab-content active"></div>
        <div id="research-panel" class="tab-content"></div>
        <div id="settings-panel" class="tab-content">
            <h3>Settings</h3>
            <button id="settings-new-game-button">New Game</button>
            <p style="font-size:0.85rem;opacity:0.8;">(Starts over and clears save)</p>
        </div>

        <div id="message-box"></div>
    </aside>

    <div id="action-buttons" style="position:fixed;bottom:1rem;left:1rem;display:flex;gap:0.5rem;z-index:40;flex-wrap:wrap;">
        <button id="open-worker-panel-button">Manage Workers</button>
        <button id="open-help-button">How To Play</button>
    </div>

    <div id="worker-panel-modal" class="hidden">
        <div class="modal-content">
            <h2>Worker Management</h2>
            <ul id="worker-assignments-list"></ul>
            <button id="close-worker-panel-button">Close</button>
        </div>
    </div>

    <div id="stats-panel-modal" class="hidden">
        <div class="modal-content">
            <h2 id="stats-name"></h2>
            <img id="stats-image" src="" alt="Building Image">
            <ul id="stats-list"></ul>
            <button id="close-stats-panel-button">Close</button>
        </div>
    </div>

    <div id="help-modal" class="hidden" style="position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0.55);z-index:200;">
        <div class="modal-content" style="max-width:520px;background:#1f2937;padding:1.2rem 1.4rem;border-radius:0.6rem;box-shadow:0 10px 30px rgba(0,0,0,0.5);">
            <h2>How To Play</h2>
            <div class="help-scroll" style="max-height:300px;overflow:auto;text-align:left;font-size:0.9rem;line-height:1.35;">
                <p><strong>Goal:</strong> Rebuild a thriving vertical colony. Provide housing, assign workers, research tech, and reach advanced structures.</p>
                <p><strong>Basics:</strong><br>
                1. Build Housing (Shack/House) to raise Population Cap.<br>
                2. Population grows automatically if you have free housing, food, and decent happiness.<br>
                3. Assign workers in production buildings (Manage Workers button). Idle workers reduce happiness slightly.<br>
                4. Farms produce Food; citizens consume Food every second. Keep buffer to allow births.<br>
                5. Industry buildings create advanced resources (Glass, Tools, Knowledge) but may consume inputs.</p>
                <p><strong>Research:</strong> Spend Knowledge to unlock new buildings. Multiple Labs speed research but cost workers.</p>
                <p><strong>Events:</strong> Random temporary boosts or challenges appear. Watch the bar at top.</p>
                <p><strong>Efficiency & Scaling:</strong> Each additional building of the same type is slightly less efficient. Diversify your economy and research upgrades to progress.</p>
                <p><strong>Costs:</strong> Repeatedly building the same structure slightly increases its cost. Plan expansions.</p>
                <p><strong>Happiness:</strong> Affects production and birth rate. Provide parks and quality housing; avoid many unemployed citizens.</p>
                <p><strong>Controls:</strong> Left click to place selected building, right click (or context menu) to cancel build mode. Click a placed building to view stats. Use tabs for Build / Research / Settings.</p>
                <p><strong>Victory:</strong> Complete all scenario objectives. Continue sandboxing afterwards.</p>
            </div>
            <button id="close-help-button" style="margin-top:0.75rem;width:100%;background:#374151;border:1px solid #4b5563;color:#fff;padding:0.55rem 0.75rem;border-radius:0.4rem;cursor:pointer;">Close</button>
        </div>
    </div>

    

    <script src="script.js" defer></script>
</body>